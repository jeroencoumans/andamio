window.Andamio={},Andamio.dom=function(){"use strict";return{win:window,doc:$(window.document),html:$("html"),viewport:$(".viewport"),pageView:$(".js-page-view"),parentView:$(".js-parent-view"),childView:$(".js-child-view"),modalView:$(".js-modal-view")}}(),Andamio.config=function(){"use strict";var e=function(e){var t=this.os={},n=this.browser={},r=e.match(/WebKit\/([\d.]+)/),i=e.match(/(Android)\s+([\d.]+)/),s=e.match(/(iPad).*OS\s([\d_]+)/),o=!s&&e.match(/(iPhone\sOS)\s([\d_]+)/),u=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),a=u&&e.match(/TouchPad/),f=e.match(/Kindle\/([\d.]+)/),l=e.match(/Silk\/([\d._]+)/),c=e.match(/(BlackBerry).*Version\/([\d.]+)/),h=e.match(/(BB10).*Version\/([\d.]+)/),p=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),d=e.match(/PlayBook/),v=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),m=e.match(/Firefox\/([\d.]+)/);if(n.webkit=!!r)n.version=r[1];i&&(t.android=!0,t.version=i[2]),o&&(t.ios=t.iphone=!0,t.version=o[2].replace(/_/g,".")),s&&(t.ios=t.ipad=!0,t.version=s[2].replace(/_/g,".")),u&&(t.webos=!0,t.version=u[2]),a&&(t.touchpad=!0),c&&(t.blackberry=!0,t.version=c[2]),h&&(t.bb10=!0,t.version=h[2]),p&&(t.rimtabletos=!0,t.version=p[2]),d&&(n.playbook=!0),f&&(t.kindle=!0,t.version=f[1]),l&&(n.silk=!0,n.version=l[1]),!l&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0),v&&(n.chrome=!0,n.version=v[1]),m&&(n.firefox=!0,n.version=m[1]),t.tablet=!!(s||d||i&&!e.match(/Mobile/)||m&&e.match(/Tablet/)),t.phone=!t.tablet&&!!(i||o||u||c||h||v&&e.match(/Android/)||v&&e.match(/CriOS\/([\d.]+)/)||m&&e.match(/Mobile/))};return{get webapp(){return Andamio.dom.html.hasClass("webapp")},set webapp(e){e?Andamio.dom.html.removeClass("website").addClass("webapp"):Andamio.dom.html.removeClass("webapp").addClass("website")},init:function(t){e.call(this,navigator.userAgent),this.os.ios&&(this.os.ios5=this.os.version.indexOf("5.")!==-1,this.os.ios6=this.os.version.indexOf("6.")!==-1),this.os.android&&(this.os.android2=this.os.version>="2"&&this.os.version<"4",this.os.android4=this.os.version>="4"&&this.os.version<"5"),this.webapp=Andamio.dom.win.location.search.search("webapp")>0||Andamio.dom.win.navigator.standalone,this.cordova=Andamio.dom.win.navigator.userAgent.indexOf("TMGContainer")>-1,this.server=Andamio.dom.win.location.origin+Andamio.dom.win.location.pathname,this.touch="ontouchstart"in Andamio.dom.win;if(typeof t=="object")for(var n in t){if(n==="init")return;this[n]=t[n]}this.touch?this.fastclick=new FastClick(window.document.body):Andamio.dom.html.addClass("no-touch"),this.cordova&&(this.webapp=!0),(this.os.tablet||Andamio.dom.doc.width()>=980)&&Andamio.dom.html.addClass("desktop has-navigation"),this.os.ios&&Andamio.dom.html.addClass("ios"),this.os.ios5&&Andamio.dom.html.addClass("ios5"),this.os.ios6&&Andamio.dom.html.addClass("ios6"),this.os.android&&Andamio.dom.html.addClass("android"),this.os.android2&&Andamio.dom.html.addClass("android2"),this.os.android4&&Andamio.dom.html.addClass("android")}}}(),Andamio.events=function(){"use strict";return{attach:function(e,t,n){Andamio.dom.viewport.on("click",e,function(e){t(e);if(n!==!0)return!1})}}}(),Andamio.util=function(){function e(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function t(e){this.values=e||{}}return t.prototype.store=function(e,t){this.values[e]=t},t.prototype.lookup=function(e){return this.values[e]},t.prototype.contains=function(e){return Object.prototype.hasOwnProperty.call(this.values,e)&&Object.prototype.propertyIsEnumerable.call(this.values,e)},t.prototype.each=function(t){e(this.values,t)},{Dictionary:t,getUrl:function(e){var t=$(e).data("url"),n=$(e).attr("href"),r=$(e).hash;if(t)return t;if(n.substring(0,10)!=="javascript")return n;if(r)return r},getUrlList:function(e){if(!e)return;var t=[];return $(e).each(function(e,n){var r=Andamio.util.getUrl(n);r&&t.push(r)}),t},getTitle:function(e){var t=$(e).data("title"),n=$(e).text();return t?t:n}}}(),Andamio.util.delay=function(){var e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}(),Andamio.phone=function(){"use strict";return{init:function(){Andamio.config.phone={updateTimestamp:new Date,updateTimeout:18e5},navigator.bootstrap.addConstructor(function(){cordova.exec(null,null,"SplashScreen","hide",[]),Andamio.events.attach('a[target="_blank"]',function(e){var t=$(e.currentTarget),n=t.attr("href");return navigator.utility.openUrl(n,"popover"),!1}),Andamio.dom.doc.on("statusbartap",function(){var e=Andamio.views.list.lookup(Andamio.views.currentView),t=Andamio.nav.status?Andamio.dom.pageNav:e.scroller;t.scrollTo(0,400)}),Andamio.dom.doc.on("resign",function(){Andamio.config.phone.updateTimestamp=new Date}),Andamio.dom.doc.on("active",function(){var e=new Date;e-Andamio.config.updateTimestamp>Andamio.config.updateTimeout&&(Andamio.alert.status&&Andamio.alert.hide(),Andamio.views.refreshView())})})}}}(),Andamio.cache=function(){"use strict";var e;return{getCache:function(t){if(!t)return;var n=e.get(t);if(n)return n},setCache:function(t,n,r){if(!t||!n)return;var i=typeof r=="number"?r:86400;e.set(t,n,i)},deleteCache:function(t){if(!t)return;e.remove(t)},init:function(){window.lscache&&(Andamio.config.cache=window.lscache.supported(),e=window.lscache)}}}(),Andamio.connection=function(){"use strict";var e;return{goOnline:function(){Andamio.dom.html.removeClass("is-offline"),Andamio.alert.status=!1},goOffline:function(){Andamio.dom.html.addClass("is-offline"),Andamio.alert.show(e)},get status(){return!Andamio.dom.html.hasClass("is-offline")},set status(e){e?Andamio.connection.goOnline():Andamio.connection.goOffline()},init:function(){var t=this;t.status=!Andamio.dom.html.hasClass("is-offline"),e=Andamio.config.offlineMessage||'<a href="javascript:void(0)" class="action-refresh">It appears your connection isn\'t working. Try again.</a>',Andamio.dom.doc.on("ajaxSuccess",t.goOnline),Andamio.dom.doc.on("ajaxError",t.goOffline)}}}(),Andamio.page=function(){function e(e,t,n){var r=n||1440;Andamio.config.cache&&Andamio.cache.setCache(e,t,r)}function t(t,n,r){var i=t+(/\?/.test(t)?"&":"?")+(new Date).getTime();$.ajax({url:i,timeout:1e4,headers:{"X-PJAX":!0,"X-Requested-With":"XMLHttpRequest"},success:function(r){e(t,r,n)},complete:function(e){$.isFunction(r)&&r(e.responseText)}})}return{load:function(e,n,r){if(!e)return!1;var i=Andamio.cache.getCache(e);i?$.isFunction(r)&&r(i):t(e,n,function(e){$.isFunction(r)&&r(e)})},refresh:function(e,t,n){Andamio.cache.deleteCache(e),this.load(e,t,n)}}}(),Andamio.dom.pageAlert=$(".js-page-alert"),Object.defineProperties(Andamio.dom,{pageAlertText:{get:function(){return this.pageAlert.find(".js-page-alert-text").text()},set:function(e){this.pageAlert.find(".js-page-alert-text").html(e)}}}),Andamio.alert=function(){"use strict";return{show:function(e){e&&(Andamio.dom.pageAlertText=e),Andamio.dom.html.addClass("has-alert"),Andamio.dom.pageAlert.show()},hide:function(){Andamio.dom.html.removeClass("has-alert"),Andamio.dom.pageAlert.hide()},get status(){return Andamio.dom.html.hasClass("has-alert")},set status(e){e?this.show():this.hide()},init:function(){this.status=Andamio.dom.html.hasClass("has-alert"),Andamio.events.attach(".action-hide-alert",this.hide)}}}(),Andamio.dom.pageLoader=$(".js-page-loader"),Andamio.dom.pageLoaderImg=Andamio.dom.pageLoader.find(".js-page-loader-spinner"),Object.defineProperties(Andamio.dom,{pageLoaderText:{get:function(){return this.pageLoader.find(".js-page-loader-text").text()},set:function(e){this.pageLoader.find(".js-page-loader-text").html(e)}}}),Andamio.loader=function(){"use strict";return{show:function(e){e&&(Andamio.dom.pageLoaderText=e),Andamio.dom.html.addClass("has-loader"),Andamio.config.cordova?navigator.spinner&&navigator.spinner.show({message:e}):Andamio.dom.pageLoader.show()},hide:function(){Andamio.dom.html.removeClass("has-loader"),Andamio.config.cordova?navigator.spinner&&navigator.spinner.hide():Andamio.dom.pageLoader.hide()},get status(){return Andamio.dom.html.hasClass("has-loader")},set status(e){e?this.show():this.hide()},get spinnerType(){return Andamio.config.loader.type},set spinnerType(e){Andamio.config.loader.type=e},init:function(){this.status=Andamio.dom.html.hasClass("has-loader");var e;Andamio.dom.viewport.on("Andamio:views:activateView:start",function(){e=window.setTimeout(function(){Andamio.loader.show()},250)}),Andamio.dom.viewport.on("Andamio:views:activateView:finish",function(){window.clearTimeout(e),Andamio.loader.hide()})}}}(),Andamio.dom.pageNav=$(".js-page-navigation"),Andamio.dom.pageNavItems=Andamio.dom.pageNav.find(".action-nav-item"),Object.defineProperties(Andamio.dom,{pageNavActive:{get:function(){return this.pageNavItems.filter(".active")},set:function(e){var t=this.pageNavActive;t.removeClass("active"),e.addClass("active")}}}),Andamio.nav=function(){"use strict";function n(e){Andamio.dom.viewport.height(e),Andamio.dom.pageView.height(e)}var e,t;return{show:function(){Andamio.dom.html.addClass("has-navigation"),Andamio.config.webapp||n(t)},hide:function(){Andamio.dom.html.removeClass("has-navigation"),Andamio.config.webapp||n("")},get status(){return Andamio.dom.html.hasClass("has-navigation")},set status(e){e?this.show():this.hide()},init:function(){var n=this;n.status=Andamio.dom.html.hasClass("has-navigation"),e=$(window).height(),t=Andamio.dom.pageNav.height(),e>t&&(t=e,Andamio.dom.pageNav.height(t)),Andamio.events.attach(".action-show-nav",n.show),Andamio.events.attach(".action-hide-nav",n.hide),Andamio.events.attach(".action-nav-item",function(e){var t=$(e.currentTarget),r=Andamio.util.getUrl(t),i=Andamio.util.getTitle(t);Andamio.dom.pageNavActive=t,Andamio.config.tablet||n.hide(),i&&Andamio.dom.viewport.one("Andamio:views:activateView:finish",function(){Andamio.views.list.lookup("parentView").title=i}),r&&Andamio.views.openParentPage(r)})}}}(),Andamio.reveal=function(){"use strict";return{init:function(){Andamio.events.attach(".action-reveal",function(e){var t,n,r,i="active",s="."+i,o=$(e.currentTarget);if(!o)return;t=o.siblings(s),t&&t.removeClass(i),o.addClass(i),r=Andamio.util.getUrl(o);if(!r)return;n=$(r).siblings(s),n&&n.removeClass("active"),$(r).addClass(i),e.preventDefault()})}}}(),Andamio.slideshow=function(){function e(e){if(typeof e=="number"){this.wrapper=$('<div class="slideshow-dots">');for(var t=0;t<e;t++)this.wrapper.append($('<div class="slideshow-dot"></div>'));this.items=this.wrapper.find(".slideshow-dot"),Object.defineProperties(this,{active:{get:function(){return this.wrapper.find(".active")},set:function(e){this.wrapper.find(".active").removeClass("active"),$(e).addClass("active")}}}),this.active=this.items.first()}}return{init:function(t,n,r){var i=$(t).data("js-slideshow-active");this.options={startSlide:0,speed:300,continuous:!0,disableScroll:!1};if(typeof n=="object"&&typeof n!="undefined")for(var s in n)this.options[s]=n[s];if(!i){var o=new Swipe(document.getElementById(t),this.options),u=new e(o.length);return u.wrapper.insertAfter(o.container),$(o.container).next().on("click",function(e){var t=e.target;u.items.each(function(e,n){n===t&&o.slide(e,300)})}),o.callback=function(e,t){u.active=u.items[e];var n=$(t).find(".js-slideshow-media");n&&n.css("background-image","url("+n.data("src")+")"),$.isFunction(r)&&r(e,t)},$(o.container).on("click",function(e){var t=$(e.target),n=t.parents(".action-slideshow-next"),r=t.parents(".action-slideshow-prev");n.length>0&&o.next(),r.length>0&&o.prev()}),o}}}}(),Andamio.dom.pageTabs=$(".js-page-tabs"),Andamio.dom.pageTabsItems=Andamio.dom.pageTabs.find(".action-tab-item"),Object.defineProperties(Andamio.dom,{pageTabsActive:{get:function(){return this.pageTabsItems.filter(".active")},set:function(e){var t=this.pageTabsActive;t.removeClass("active"),e.addClass("active")}}}),Andamio.tabs=function(){"use strict";return{show:function(){Andamio.dom.html.addClass("has-page-tabs"),Andamio.dom.pageTabs.show()},hide:function(){Andamio.dom.html.removeClass("has-page-tabs"),Andamio.dom.pageTabs.hide()},get status(){return Andamio.dom.html.hasClass("has-page-tabs")},set status(e){e?this.show():this.hide()},init:function(){var e=this;e.status=Andamio.dom.html.hasClass("has-page-tabs"),Andamio.events.attach(".action-tab-item",function(e){var t=$(e.currentTarget),n=Andamio.util.getUrl(t),r=Andamio.util.getTitle(t);Andamio.dom.pageTabsActive=t,r&&Andamio.dom.viewport.one("Andamio:views:activateView:finish",function(){var e=Andamio.views.list.lookup(Andamio.views.currentView);e.title=r}),n&&(Andamio.views.activateView(Andamio.views.currentView,n,null,0),Andamio.views.currentUrl=n)}),Andamio.events.attach(".action-show-tabs",Andamio.tabs.show),Andamio.events.attach(".action-hide-tabs",Andamio.tabs.hide)}}}(),Andamio.views=function(){function e(e){if(e.length>0)return e[e.length-1]}function t(e){if(e&&e.length>1)return e[e.length-2]}function n(t,n){t!==e(n)&&n.push(t)}function r(e,t,n){this.container=e,t&&Object.defineProperties(this,{title:{get:function(){return this.container.find(".js-title")},set:function(e){typeof e=="string"&&this.container.find(".js-title").text(e)}},content:{get:function(){return this.container.hasClass("js-content")?this.container:this.container.find(".js-content")}},scroller:{get:function(){return this.container.hasClass("overthrow")?this.container:this.container.find(".overthrow")}}}),n&&(this.initialPosition=n,this.position=n,this.slide=function(e){var t=this.container,n=this.position;n==="slide-left"&&e==="slide-default"&&t.addClass("slide-in-from-left").one("webkitTransitionEnd",function(){t.addClass("slide-default").removeClass("slide-left slide-right slide-in-from-left")}),n==="slide-right"&&e==="slide-default"&&t.addClass("slide-in-from-right").one("webkitTransitionEnd",function(){t.addClass("slide-default").removeClass("slide-right slide-left slide-in-from-right")}),n==="slide-bottom"&&e==="slide-default"&&t.addClass("slide-in-from-bottom").one("webkitTransitionEnd",function(){t.addClass("slide-default").removeClass("slide-bottom slide-in-from-bottom")}),n==="slide-top"&&e==="slide-default"&&t.addClass("slide-in-from-top").one("webkitTransitionEnd",function(){t.addClass("slide-default").removeClass("slide-top slide-in-from-top")}),n==="slide-default"&&e==="slide-left"&&t.addClass("slide-out-to-left").one("webkitTransitionEnd",function(){t.addClass("slide-left").removeClass("slide-default slide-out-to-left")}),n==="slide-default"&&e==="slide-right"&&t.addClass("slide-out-to-right").one("webkitTransitionEnd",function(){t.addClass("slide-right").removeClass("slide-default slide-out-to-right")}),n==="slide-default"&&e==="slide-bottom"&&t.addClass("slide-out-to-bottom").one("webkitTransitionEnd",function(){t.addClass("slide-bottom").removeClass("slide-default slide-out-to-bottom")}),n==="slide-default"&&e==="slide-top"&&t.addClass("slide-out-to-top").one("webkitTransitionEnd",function(){t.addClass("slide-top").removeClass("slide-default slide-out-to-top")}),this.position=e})}function i(){this.list=new Andamio.util.Dictionary({parentView:new r(Andamio.dom.parentView,!0,"slide-default"),childView:new r(Andamio.dom.childView,!0,"slide-right"),modalView:new r(Andamio.dom.modalView,!0,"slide-bottom")});var i=[],s=[],o=[];this._urlHistory=function(){return i},this._viewHistory=function(){return s},this._scrollHistory=function(){return o},this.childCount=0,this.modalCount=0;var u=!0;Object.defineProperties(this,{currentUrl:{get:function(){return e(i)},set:function(e){n(e,i)}},previousUrl:{get:function(){return t(i)}},currentView:{get:function(){return e(s)},set:function(e){s.push(e)}},previousView:{get:function(){return t(s)}},scrollPosition:{get:function(){return e(o)},set:function(e){o.push(e)}}}),this.resetViews=function(){this.list.each(function(e){var t=Andamio.views.list.lookup(e);t.reset()}),s=[],i=[],o=[],u=!0},this.activateView=function(e,t,n,r){if(this.list.contains(e)){var i=this.list.lookup(e);i.active=!0,t&&(Andamio.dom.doc.trigger("Andamio:views:activateView:start",[t]),i.content.empty(),Andamio.page.load(t,n,function(e){i.content.html(e),typeof r=="number"&&(i.scroller[0].scrollTop=r),Andamio.dom.doc.trigger("Andamio:views:activateView:finish",[t])}))}},this.deactivateView=function(e){if(this.list.contains(e)){var t=this.list.lookup(e);t.active=!1}},this.pushView=function(e,t,n,r){this.list.contains(e)&&(this.currentView=e,t&&(this.currentUrl=t),this.previousView&&(this.scrollPosition=this.list.lookup(this.previousView).scroller[0].scrollTop),this.activateView(e,t,n,r),this.deactivateView(this.previousView))},this.popView=function(){this.previousView&&(this.deactivateView(this.currentView),u?this.activateView(this.previousView):this.activateView(this.previousView,this.previousUrl,!1,this.scrollPosition),s.pop(),i.pop(),o.pop(),this.childCount===0&&(u=!0))},this.refreshView=function(e){var t=this.currentUrl,n=this.list.lookup(this.currentView);t&&(n.content.empty(),Andamio.page.refresh(t,e,function(e){n.content.html(e)}))},this.openParentPage=function(e,t){this.resetViews();var n=t||1440;this.pushView("parentView",e,n)},this.pushModal=function(e,t){if(this.modalCount>0)return!1;Andamio.config.webapp&&this.list.lookup("modalView").slide("slide-default"),this.pushView("modalView",e,t),this.modalCount++},this.popModal=function(){if(!(this.modalCount>0))return!1;Andamio.config.webapp&&this.list.lookup("modalView").slide("slide-bottom"),this.popView(),this.modalCount--},this.pushChild=function(e,t){this.childCount++,this.childCount>1&&(u=!1);var n=this.list.lookup("parentView"),r=this.list.lookup("childView");this.childCount%2>0?(Andamio.config.webapp&&(Andamio.dom.childView.removeClass("slide-left").addClass("slide-right"),Andamio.util.delay(function(){n.slide("slide-left"),r.slide("slide-default")},0)),this.pushView("childView",e,t,0)):(Andamio.config.webapp&&(Andamio.dom.parentView.removeClass("slide-left").addClass("slide-right"),Andamio.util.delay(function(){n.slide("slide-default"),r.slide("slide-left")},0)),this.pushView("parentView",e,t,0))},this.popChild=function(){var e=this.list.lookup("parentView"),t=this.list.lookup("childView");this.childCount%2>0?Andamio.config.webapp&&(Andamio.dom.parentView.removeClass("slide-right").addClass("slide-left"),Andamio.util.delay(function(){e.slide("slide-default"),t.slide("slide-right")},0)):Andamio.config.webapp&&(Andamio.dom.childView.removeClass("slide-right").addClass("slide-left"),Andamio.util.delay(function(){t.slide("slide-default"),e.slide("slide-right")},0)),this.popView(),this.childCount--},this.init=function(){typeof Andamio.config.initialView=="string"&&Andamio.views.openParentPage(Andamio.config.initialView),Andamio.events.attach(".action-push",function(e){var t=$(e.currentTarget),n=Andamio.util.getUrl(t);Andamio.views.pushChild(n)}),Andamio.events.attach(".action-show-modal",function(e){var t=$(e.currentTarget),n=Andamio.util.getUrl(t);Andamio.views.pushModal(n)}),Andamio.events.attach(".action-pop",function(){Andamio.views.popChild()}),Andamio.config.os.android&&navigator.bootstrap.addConstructor(function(){Andamio.dom.doc.addEventListener("backbutton",function(){Andamio.views.popChild()})}),Andamio.events.attach(".action-hide-modal",function(){Andamio.views.popModal()}),Andamio.events.attach(".action-refresh",function(){Andamio.views.refreshView()})}}return r.prototype.reset=function(){this.position&&Andamio.config.webapp&&(this.position=this.initialPosition,this.container.removeClass("slide-left").removeClass("slide-right").removeClass("slide-default").removeClass("slide-bottom").addClass(this.position)),this.active=!1},Object.defineProperties(r,{active:{get:function(){return this.container.hasClass("view-active")},set:function(e){e?this.container.addClass("view-active").removeClass("view-hidden"):this.container.addClass("view-hidden").removeClass("view-active")}}}),new i}(),Andamio.init=function(e){Andamio.config.init(e),Andamio.alert.init(),Andamio.cache.init(),Andamio.connection.init(),Andamio.loader.init(),Andamio.views.init(),Andamio.nav.init(),Andamio.tabs.init(),Andamio.reveal.init(),Andamio.config.cordova&&Andamio.phone.init()};