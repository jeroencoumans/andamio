<!DOCTYPE html>
<html lang="nl" class="website">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Andamio">
    <title>Andamio</title>
    <link rel="stylesheet" type="text/css" href="../dist/andamio.css">
</head>

<body class="viewport">

    <div class="js-page-view page-view">

        <div class="js-parent-view parent-view view-active">
            <div class="page-header">
                <a href="javascript:void(0)" class="page-logo js-title">Parent</a>
                <a href="javascript:void(0);" class="button-header-wrapper action-show-nav"><span class="button-header">Menu</span></a>
                <a href="javascript:void(0)" class="button-header-wrapper-alternate action-show-modal" data-title="Example" data-url="blocks/modal.html"><span class="button-header">Modal</span></a>
            </div>

            <div class="page-content overthrow">
                <div class="js-pull-to-refresh pull-to-refresh hidden-website">
                    <span class="pull-to-refresh-date">Last updated: <span class="js-refresh-date"></span></span>
                    <i class="icon icon-arrow-down"></i>
                    <h4 class="pull-to-refresh-text-pull">Pull down to refresh</h4>
                    <h4 class="pull-to-refresh-text-release">Release to refresh</h4>
                    <h4 class="pull-to-refresh-text-loading">Loading&hellip;</h4>
                </div>
                <div class="js-content"></div>
            </div>
        </div>

        <div class="js-child-view child-view view-hidden">
            <div class="page-header">
                <a href="/" class="page-logo js-title"></a>
                <a href="javascript:void(0)" class="button-header-wrapper action-pop"><span class="button-header">Terug</span></a>
            </div>
            <div class="js-content page-content overthrow"></div>
        </div>

        <div class="js-child-view-alternate child-view view-hidden">
            <div class="page-header">
                <a href="/" class="page-logo js-title"></a>
                <a href="javascript:void(0)" class="button-header-wrapper action-pop"><span class="button-header">Terug</span></a>
            </div>
            <div class="js-content page-content overthrow"></div>
        </div>

        <div class="js-page-tabs page-tabs">
            <a href="blocks/parent.html" class="tab-item active action-tab-item p33">
                <i class="icon tab-item-icon"></i>
                <span class="tab-item-label">Tab 1</span>
            </a>
            <a href="blocks/tabs.html" class="tab-item action-tab-item p33">
                <i class="icon tab-item-icon"></i>
                <span class="tab-item-label">Tab 2</span>
            </a>
            <a href="blocks/tabs.html" class="tab-item action-tab-item p33">
                <i class="icon tab-item-icon"></i>
                <span class="tab-item-label">Tab 3</span>
            </a>
        </div>
    </div>

    <div class="js-page-navigation page-navigation overthrow">
        <h2 class="navigation-header">Header</h2>
        <a href="blocks/parent.html" class="navigation-item active action-nav-item">Parent</a>
        <a href="blocks/reveal.html" class="navigation-item action-nav-item">Reveal</a>
        <a href="blocks/buttons.html" class="navigation-item action-nav-item">Buttons</a>
        <a href="blocks/grid.html" class="navigation-item action-nav-item">Grid</a>
        <a href="blocks/sharing.html" class="navigation-item action-nav-item">Sharing</a>
        <a href="javascript:void(0)" class="navigation-item action-refresh">Refresh</a>
        <a href="javascript:lscache.flush()" class="navigation-item">Empty cache</a>
    </div>

    <a href="javascript:void(0)" class="page-navigation-toggle action-hide-nav"></a>

    <div class="js-modal-view modal-view view-hidden">
        <div class="page-header">
            <a href="/" class="page-logo js-title">Default modal title</a>
            <a href="javascript:void(0);" class="button-header-wrapper action-hide-modal"><span class="button-header button-primary">Close</span></a>
        </div>
        <div class="js-content page-content overthrow"></div>
    </div>

    <div class="js-page-loader page-loader display-none">
        <i class="js-page-loader-spinner page-loader-spinner"></i>
        <div class="js-page-loader-text page-loader-text">Loading&hellip;</div>
    </div>

    <div class="js-page-alert page-alert display-none">
        <div class="js-page-alert-text page-alert-text"></div>
        <a href="javascript:void(0)" class="action-hide-alert page-alert-button button button-block">Close</a>
    </div>

    <script src="../dist/andamio.zepto.js"></script>
    <!--<script src="../dist/andamio.jquery.js"></script>-->
    <script>

    // Yes, everything is available so just start it up already
    var parentPager,
        parentSlideshow,
        childPager,
        childSlideshow;

    // Setup listeners for activating pager and slideshow
    Andamio.dom.doc.on("Andamio:views:activateView:finish", function () {

        switch (Andamio.views.currentView) {

        case Andamio.views.parentView:

            if (parentPager) {
                console.log("deactivate pager");

                parentPager.disable();
                parentPager = null;
            }

            var pagerEl = Andamio.views.currentView.content.find(".js-pager-list");

            if (pagerEl.length) {

                console.log("activate pager");

                parentPager = Andamio.pager.init({
                    autoFetch           : true,
                    autoFetchMax        : 2,
                    autoFetchThreshold  : 300,
                    url                 : Andamio.config.server + "pager/",
                    callback            : function (pageNumber) {
                        console.log("Loading page " + pageNumber);
                    },
                });
            }

            if (parentSlideshow) {
                console.log("deactivate parent slideshow");

                parentSlideshow.destroy();
                parentSlideshow = null;
            }

            var slideshowEl = Andamio.views.currentView.content.find(".slideshow-wrapper").attr("id");

            if (slideshowEl) {

                console.log("activate parent slideshow");

                parentSlideshow = new Andamio.slideshow.init(slideshowEl, null, function (slideNumber) {
                    console.log("Swiped item " + slideNumber);
                });
            }

            break;

        case Andamio.views.childView:
        case Andamio.views.childViewAlt:

            if (childPager) {
                console.log("deactivate pager");

                childPager.disable();
                childPager = null;
            }

            var pagerEl = Andamio.views.currentView.content.find(".js-pager-list");

            if (pagerEl.length) {

                console.log("activate pager");

                childPager = Andamio.pager.init({
                    autoFetch           : true,
                    autoFetchMax        : 2,
                    autoFetchThreshold  : 300,
                    url                 : Andamio.config.server + "pager/",
                    callback            : function (pageNumber) {
                        console.log("Loading page " + pageNumber);
                    },
                });
            }

            if (childSlideshow) {
                console.log("deactivate child slideshow");

                childSlideshow.destroy();
                childSlideshow = null;
            }

            var slideshowEl = Andamio.views.currentView.content.find(".slideshow-wrapper").attr("id");

            if (slideshowEl) {

                console.log("activate child slideshow");

                childSlideshow = Andamio.slideshow.init(slideshowEl, null, function (slideNumber) {
                    console.log("Swiped item " + slideNumber);
                });
            }

            break;
        }
    });

    // Initialize
    Andamio.init({
        title: "Andamio",
        initialView: "blocks/parent.html",
        social: {
            twitter: "jeroencoumans",
            facebook: 497899636895210
        }
    });

    // Setup pull to refresh
    if (Andamio.config.webapp) {
        Andamio.pulltorefresh.init();
    }

    </script>

</body>
</html>
